{"version":3,"sources":["../../src/utils/verifyPerm.js"],"names":["jwtConfig","require","jwt","verifyAuth","req","res","next","token","headers","status","send","auth","message","verify","secret","err","decoded","admin","console","log","module","exports"],"mappings":";;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,uBAAD,CAAzB;;AACA,IAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB;;AAGA,SAASE,UAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;AAChC,MAAIC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,CAAZ;;AAEA,MAAG,CAACD,KAAJ,EAAW;AACP,WAAOF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,MAAAA,IAAI,EAAE,KADkB;AAExBC,MAAAA,OAAO,EAAE;AAFe,KAArB,CAAP;AAIH;;AAEDV,EAAAA,GAAG,CAACW,MAAJ,CAAWN,KAAX,EAAkBP,SAAS,CAACc,MAA5B,EAAoC,UAASC,GAAT,EAAcC,OAAd,EAAuB;AACvD,QAAGD,GAAG,IAAI,CAACC,OAAO,CAACC,KAAnB,EAA0B;AACtBC,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAYJ,GAAxB;AACA,aAAOV,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,QAAAA,IAAI,EAAE,KADkB;AAExBC,QAAAA,OAAO,EAAE;AAFe,OAArB,CAAP;AAIH;;AACDN,IAAAA,IAAI;AACP,GATD;AAUH;;AAEDc,MAAM,CAACC,OAAP,GAAiBlB,UAAjB","sourcesContent":["const jwtConfig = require('../configs/jwt.config');\nconst jwt = require('jsonwebtoken');\n\n\nfunction verifyAuth(req, res, next) {\n    let token = req.headers['x-access-token'];\n\n    if(!token) {\n        return res.status(400).send({\n            auth: false,\n            message: \"The request has not been applied because the authentication token is missing.\"\n        })\n    }\n\n    jwt.verify(token, jwtConfig.secret, function(err, decoded) {\n        if(err || !decoded.admin) {\n            console.log(\"[AUTH] \" + err);\n            return res.status(401).send({\n                auth: false,\n                message: \"The request has not been applied because it lacks valid permissions for the target resource.\"\n            })\n        }\n        next();\n    });\n}\n\nmodule.exports = verifyAuth;"],"file":"verifyPerm.js"}