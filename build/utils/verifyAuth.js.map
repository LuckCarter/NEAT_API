{"version":3,"sources":["../../src/utils/verifyAuth.js"],"names":["jwtConfig","require","jwt","verifyToken","req","res","next","token","headers","status","send","auth","message","verify","secret","err","decoded","console","log","module","exports"],"mappings":";;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,uBAAD,CAAzB;;AACA,IAAMC,GAAG,GAAGD,OAAO,CAAC,cAAD,CAAnB;;AAGA,SAASE,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACjC,MAAIC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,CAAZ;;AAEA,MAAG,CAACD,KAAJ,EAAW;AACP,WAAOF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,MAAAA,IAAI,EAAE,KADkB;AAExBC,MAAAA,OAAO,EAAE;AAFe,KAArB,CAAP;AAIH;;AAEDV,EAAAA,GAAG,CAACW,MAAJ,CAAWN,KAAX,EAAkBP,SAAS,CAACc,MAA5B,EAAoC,UAASC,GAAT,EAAcC,OAAd,EAAuB;AACvD,QAAGD,GAAH,EAAQ;AACJE,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAYH,GAAxB;AACA,aAAOV,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,QAAAA,IAAI,EAAE,KADkB;AAExBC,QAAAA,OAAO,EAAE;AAFe,OAArB,CAAP;AAIH;;AACDN,IAAAA,IAAI;AACP,GATD;AAUH;;AAEDa,MAAM,CAACC,OAAP,GAAiBjB,WAAjB","sourcesContent":["const jwtConfig = require('../configs/jwt.config');\nconst jwt = require('jsonwebtoken');\n\n\nfunction verifyToken(req, res, next) {\n    let token = req.headers['x-access-token'];\n\n    if(!token) {\n        return res.status(400).send({\n            auth: false,\n            message: \"The request has not been applied because the authentication token is missing.\"\n        })\n    }\n\n    jwt.verify(token, jwtConfig.secret, function(err, decoded) {\n        if(err) {\n            console.log(\"[AUTH] \" + err);\n            return res.status(401).send({\n                auth: false,\n                message: \"The request has not been applied because it lacks valid authentication credentials for the target resource.\"\n            })\n        }\n        next();\n    });\n}\n\nmodule.exports = verifyToken;"],"file":"verifyAuth.js"}